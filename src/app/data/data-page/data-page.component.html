<div class="container my-5">
    <h1 class="dfrm-page-title text-center">CDMS Data Access</h1>
    <div class="row align-items-center">
        <div class="col-10 offset-1">
            <ng-select [items]="datastores" bindLabel="Name" bindValue="Id" placeholder="Select Datastore"
                (change)="handleChange(selectedDatastore)" [(ngModel)]="selectedDatastore"></ng-select>
        </div>

    </div>
    <app-data-filters (dataFilters)="getDataFilters($event)" [selectedDatastore]="selectedDatastore"></app-data-filters>
    <div class="row">
        <app-button [label]="'Retrieve Data'" (click)="retrieveData()" [loading]="isLoading" [style]="btnStyle"></app-button>
    </div>
    <br>

    <div class="container my-5" style="height: 600px;">
        <h2 *ngIf="loadedDataset">{{loadedDataset}}</h2>
        <ag-grid-angular style="width: 100%; height: 100%; font-size:20px" class="ag-theme-alpine"
            [columnDefs]="columnDefs" [defaultColDef]="defaultColDef" [rowData]="data" [rowSelection]="'multiple'"
            [suppressCellFocus]="true" (gridReady)="onGridReady($event)" [animateRows]="true">
        </ag-grid-angular>
    </div>
    <br>
    <div class="row align-items-center">
        <div class="col-5 offset-3">
            <p><em>Filters applied in the grid will be reflected in the exported CSV.</em></p>
        </div>
        <div class="col-3 offset-1">
            <app-button [label]="'Export CSV'" (click)="exportData()" [style]="btnStyle"
                [disabled]="isLoading || !data"></app-button>
        </div>
    </div>
</div>